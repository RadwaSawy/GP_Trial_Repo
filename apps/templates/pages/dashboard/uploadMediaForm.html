<div>
  <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal"
    data-bs-whatever="@mdo">
    <svg class="icon icon-xs me-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"
      xmlns="http://www.w3.org/2000/svg">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
    </svg>
    Upload a Media file
  </button>

  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Uploading</h5>
        </div>
        <div class="modal-body">
          <form method="POST" enctype="multipart/form-data">
            <div class="mb-3">
              <label for="recipient-name" class="col-form-label">Media Name</label>
              <input type="text" class="form-control" name="media_name">
            </div>
            <div class="form-check">
              <div class="mb-3">
                <input class="form-check-input" type="radio" name="exampleRadios1" id="exampleRadios1" value="option1"
                  checked>
                <label class="form-check-label" for="exampleRadios1">
                  Upload Media File
                </label>
                <input class="form-control" type="file" name="file" id="formFile">
              </div>
              <div class="mb-3">
                <input class="form-check-input" type="radio" name="exampleRadios2" id="exampleRadios2" value="option2">
                <label class="form-check-label" for="exampleRadios2">
                  Media URL
                </label>
                <input type="text" class="form-control" name="url" disabled>
              </div>
            </div>
            <div class="mb-3">
              <label for="recipient-name" class="col-form-label">Type</label>
              <select class="form-select mb-0" name="media_type_form" id="media_type_form"
                aria-label="Media select example">
                <option value="Audio">Audio</option>
                <option value="Video">Video</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="recipient-name" class="col-form-label">Employee Name</label>
              <select class="form-select mb-0" name="employee_id" id="empolyee_id_data"
                aria-label="Location select example">
                {% for data in emp %}
                <option value="{{ data.id }}">{{ data.name }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="mb-3">
              <label for="recipient-name" class="col-form-label">Location</label>
              <select class="form-select mb-0" name="location" id="empolyee_location"
                aria-label="Location select example">
                {% for location in emp_loc %}
                <option value="{{ location.id }}">{{ location.name }}</option>
                {% endfor %}
              </select>
            </div>
            <button type="submit" class="btn btn-primary" id="uploadButton">Upload</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 9999;
    background-color: rgba(255, 255, 255, 0.7);
    display: flex;
    justify-content: center;
    align-items: center;
    visibility: hidden;
  }

  .loading-indicator {
    display: flex;
    align-items: center;
    flex-direction: column;
  }

  .loading-bar {
    width: 200px;
    height: 20px;
    background-color: #ddd;
    border-radius: 10px;
    margin-top: 10px;
  }

  .loading-progress {
    width: 0;
    height: 100%;
    background-color: #0d6efd;
    border-radius: 10px;
    transition: width 0.3s ease-in-out;
  }

  .loading-message {
    margin-top: 10px;
    text-align: center;
    font-size: 14px;
    font-weight: bold;
  }
</style>

<script>
  const uploadButton = document.getElementById("uploadButton");
  const loadingOverlay = document.createElement("div");
  loadingOverlay.classList.add("loading-overlay");
  loadingOverlay.innerHTML = `
    <div class="loading-indicator">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <div class="loading-bar">
        <div class="loading-progress"></div>
      </div>
      <div class="loading-message">Please wait while your video is processing</div>
    </div>
  `;
  document.body.appendChild(loadingOverlay);

  uploadButton.addEventListener("click", () => {
    loadingOverlay.style.visibility = "visible";
    simulateProcessing();
  });

  function simulateProcessing() {
    const progressBar = document.querySelector(".loading-progress");
    const message = document.querySelector(".loading-message");

    let progress = 0;
    let intervalId = setInterval(() => {
      progress += 10;
      progressBar.style.width = `${progress}%`;

      if (progress === 100) {
        clearInterval(intervalId);
        message.textContent = "Analyzing your customers' emotions...";
        simulateAnalysis();
      }
    }, 1000);
  }

  function simulateAnalysis() {
    const progressBar = document.querySelector(".loading-progress");
    const message = document.querySelector(".loading-message");

    let progress = 0;
    let intervalId = setInterval(() => {
      progress += 0.001;
      progressBar.style.width = `${progress}%`;

      if (progress === 100) {
        clearInterval(intervalId);
        message.textContent = "Your video analysis is complete";
      }
    }, 1000);
  }
</script>
